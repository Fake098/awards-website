<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Image Scrolling</title>
		<style>
			html.lenis,
			html.lenis body {
				height: auto;
			}

			.lenis.lenis-smooth {
				scroll-behavior: auto !important;
			}

			.lenis.lenis-smooth [data-lenis-prevent] {
				overscroll-behavior: contain;
			}

			.lenis.lenis-stopped {
				overflow: hidden;
			}

			.lenis.lenis-smooth iframe {
				pointer-events: none;
			}
		</style>
		<script src="https://cdn.tailwindcss.com"></script>
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"
			integrity="sha512-7eHRwcbYkK4d9g/6tD/mhkf++eoTHwpNM9woBxtPUBWm67zeAfFC+HrdoE2GanKeocly/VxeLvIqwvCdk7qScg=="
			crossorigin="anonymous"
			referrerpolicy="no-referrer"
		></script>
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"
			integrity="sha512-onMTRKJBKz8M1TnqqDuGBlowlH0ohFzMXYRNebz+yOcc5TQr/zAKsthzhuv0hiyUKEiQEQXEynnXCvNTOk50dg=="
			crossorigin="anonymous"
			referrerpolicy="no-referrer"
		></script>
	</head>
	<body>
		<div class="w-full bg-zinc-900">
			<div class="parent relative w-full h-[2000vh]">
				<div class="w-full h-screen sticky top-0 left-0">
					<canvas class="w-full h-screen" id="canvas"></canvas>
					<div
						class="absolute animate1 z-[2] text-white bottom-10 w-1/2 left-10"
					>
						<h1 class="leading-20 font-[100] text-3xl">&copy; 2024 DOZE STD</h1>
						<h1 class="text-3xl">SHAPING BRANDS >>> CRAFTING MOTION</h1>
					</div>
					<div
						class="absolute animate2 flex z-[2] text-white bottom-10 w-1/2 right-10 text-right opacity-0"
					>
						<h1 class="leading-20 font-[100] uppercase text-6xl">
							Transforming Visions
						</h1>
						<h1 class="text-xl w-1/2">
							Building identity and inspiring action. Scultpting digital
							experiences that resonate.
						</h1>
					</div>
					<div
						class="absolute animate3 z-[2] text-white top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-center opacity-0"
					>
						<h1 class="leading-20 font-[100] uppercase text-6xl">
							Elevating Aesthetics
						</h1>
						<h1 class="text-xl">
							Crafting solutions and exploring new horizons. Evolving narratives
							and elevating aesthetics in every project.
						</h1>
					</div>
					<div
						class="w-1/3 panel translate-x-full h-screen bg-white absolute right-0 top-0 z-[2] p-10"
					>
						<h3 class="panelelem text-xl font-[100]">o 2024 Doze.Std</h3>
						<p class="panelelem mt-10 text-xl">
							Lorem ipsum dolor sit amet consectetur adipisicing elit. Qui sequi
							commodi animi ex suscipit earum totam molestiae magnam facilis
							earum excepturi iure eligendi.
						</p>
						<button
							class="panelelem border-[1px] px-3 py-2 border-[#555] font-[100] mt-6"
						>
							Get Reviews
						</button>
						<div class="panelelem absolute bottom-10">
							<h3 class="text-xl">Innovating Design</h3>
							<p class="text-sm mt-3">
								Connecting ideas to foster creativity. Designing impactful
								experiences that resonate.
							</p>
							<button
								class="bg-black text-white px-7 text-sm mt-4 py-4 font-[100] capitalize"
							>
								experience
							</button>
						</div>
					</div>
					<div
						class="absolute z-[2] panelism text-white top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-center text-6xl tracking-tighter opacity-0"
					>
						&copy;Panelism
						<span class="line w-10 h-1 bg-white inline-block"></span> 2048
					</div>
				</div>
			</div>
			<div class="w-full py-32 px-10 bg-white">
				<h1 class="text-8xl tracking-tighter">&reg; Our Recent Works.</h1>
				<div class="w-1/2 p-3 mt-32 headings gap-10 flex flex-col">
					<h3 class="text-7xl">Heading 1</h3>
					<h3 class="text-7xl">Heading 2</h3>
					<h3 class="text-7xl">Heading 3</h3>
					<h3 class="text-7xl">Heading 4</h3>
					<h3 class="text-7xl">Heading 5</h3>
					<h3 class="text-7xl">Heading 6</h3>
					<h3 class="text-7xl">Heading 7</h3>
					<h3 class="text-7xl">Heading 8</h3>
					<h3 class="text-7xl">Heading 9</h3>
					<h3 class="text-7xl">Heading 10</h3>
					<h3 class="text-7xl">Heading 11</h3>
					<h3 class="text-7xl">Heading 12</h3>
				</div>
			</div>
		</div>
		<script src="https://unpkg.com/lenis@1.1.13/dist/lenis.min.js"></script>
		<script>
			const canvas = document.querySelector("#canvas");
			const context = canvas.getContext("2d");
			const frames = {
				currentIndex: 1,
				maxIndex: 538,
			};
			let imagesLoaded = 0;
			const images = [];
			function preloadImages() {
				for (let i = 1; i <= frames.maxIndex; i++) {
					const imageUrl = `./frames/frame_${i
						.toString()
						.padStart(4, "0")}.jpg`;
					const img = new Image();
					img.src = imageUrl;

					img.onload = function () {
						imagesLoaded++;
						if (imagesLoaded == frames.maxIndex) {
							loadImage(frames.currentIndex);
							startAnimation();
						}
					};

					images.push(img);
				}
			}

			function loadImage(index) {
				if (index >= 0 && index <= frames.maxIndex) {
					const img = images[index];
					canvas.height = window.innerHeight;
					canvas.width = window.innerWidth;

					const scaleX = canvas.width / img.width;
					const scaleY = canvas.height / img.height;
					const scale = Math.max(scaleX, scaleY);

					const newWidth = img.width * scale;
					const newHeight = img.height * scale;

					const offsetX = (canvas.width - newWidth) / 2;
					const offsetY = (canvas.height - newHeight) / 2;

					context.clearRect(0, 0, canvas.width, canvas.height);
					context.imageSmoothingEnabled = true;
					context.imageSmoothingQuality = "high";
					context.drawImage(img, offsetX, offsetY, newWidth, newHeight);
					frames.currentIndex = index;
				}
			}

			function startAnimation() {
				var tl = gsap.timeline({
					scrollTrigger: {
						trigger: ".parent",
						start: "top top",
						scrub: 2,
						end: "bottom bottom",
					},
				});
				function updateFrame(index) {
					return {
						currentIndex: index,
						onUpdate: function () {
							loadImage(Math.floor(frames.currentIndex));
						},
					};
				}
				tl.to(frames, updateFrame(50), "a")
					.to(".animate1", { opacity: 0, ease: "linear" }, "a")
					.to(frames, updateFrame(80), "b")
					.to(".animate2", { opacity: 1, ease: "linear" }, "b")
					.to(frames, updateFrame(110), "c")
					.to(".animate2", { opacity: 1, ease: "linear" }, "c")
					.to(frames, updateFrame(140), "d")
					.to(".animate2", { opacity: 0, ease: "linear" }, "d")
					.to(frames, updateFrame(170), "e")
					.to(".animate3", { opacity: 1, ease: "linear" }, "e")
					.to(frames, updateFrame(200), "f")
					.to(".animate3", { opacity: 1, ease: "linear" }, "f")
					.to(frames, updateFrame(230), "g")
					.to(".animate3", { opacity: 0, ease: "linear" }, "g")
					.to(frames, updateFrame(260), "h")
					.to(".panel", { x: "0%", ease: "expo" }, "h")
					.to(frames, updateFrame(290), "i")
					.to(".panel", { x: "0%", ease: "expo" }, "i")
					.to(frames, updateFrame(320), "j")
					.to(".panel", { opacity: 0, ease: "linear" }, "j")
					.to(frames, updateFrame(350), "j")
					.to("canvas", { scale: 0.5, ease: "linear" }, "j")
					.to(frames, updateFrame(380), "k")
					.to(".panelism", { opacity: 1, ease: "expo" }, "k")
					.to(frames, updateFrame(410), "l")
					.to(".panelism span", { width: 200, ease: "expo" }, "l")
					.to(frames, updateFrame(440), "m")
					.to("canvas", { scale: 1, ease: "linear" }, "m")
					.to(frames, updateFrame(480), "n")
					.to(".panelism", { scale: 2, ease: "circ" }, "n")
					.to(frames, updateFrame(537), "o")
					.to(".panelism", { scale: 2, ease: "circ" }, "o");
			}

			window.addEventListener("resize", function () {
				loadImage(Math.floor(frames.currentIndex));
			});

			const lenis = new Lenis();

			function raf(time) {
				lenis.raf(time);
				requestAnimationFrame(raf);
			}

			requestAnimationFrame(raf);

			preloadImages();

			document.querySelectorAll(".headings h3").forEach(function (elem) {
				gsap.from(elem, {
					scrollTrigger: {
						trigger: elem,
						start: "top 90%",
						end: "bottom 20%",
						scrub: 2,
					},
					opacity: 0.3,
				});
			});
		</script>
	</body>
</html>
